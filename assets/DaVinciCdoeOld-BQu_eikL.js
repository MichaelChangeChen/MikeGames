import{r as m,j as Y,p as j,_ as A,c as D,b as w,f as r,g as O,w as P,F as S,m as E,T as $,o as b,t as z}from"./index-MMec5jZy.js";import{r as L,a as U}from"./getApi-0pKo1JwH.js";const H=()=>{const e=m(250),l=m(15),_=m(0),k=m(4),C=m(0),p=m(.3),o=m([]),u=m(null),q=()=>{L().then(a=>{a.data.statusCode===1?(_.value=a.data.max_num,I(),B()):console.log("連線出現問題~")}).catch(a=>{console.log(a)})},G=a=>new Promise(s=>setTimeout(s,a)),I=async()=>{o.value=[];for(let a=0;a<_.value;a++)await N(a),await G(100)},N=a=>{let s=Math.random()*Math.PI+Math.PI,t=e.value+Math.cos(s)*(Math.random()-.5)*(e.value-l.value),n=e.value+Math.sin(s)*Math.random()*(e.value-l.value);o.value.push({id:a+1,x:t,y:n,vx:(Math.random()-.5)*2,vy:0,settled:!1})},B=()=>{o.value=o.value.map(a=>{a.vy+=k.value;let s=a.y+a.vy,t=a.x;Math.sqrt((t-e.value)**2+(s-e.value)**2)+l.value>e.value&&(s=e.value+Math.sqrt(e.value**2-(t-e.value)**2)-l.value,a.vy=-a.vy*p.value);let v=!1;return o.value.forEach(c=>{if(a.id===c.id)return;const i=t-c.x,h=s-c.y,d=Math.sqrt(i**2+h**2),x=2*l.value;if(d<x&&d>0){v=!0;const f=Math.atan2(h,i),y=x-d,g=y*Math.cos(f),F=y*Math.sin(f);if(c.settled||(t+=g/2,s+=F/2,c.x-=g/2,c.y-=F/2),Math.sqrt((t-e.value)**2+(s-e.value)**2)+l.value>e.value){const V=Math.atan2(s-e.value,t-e.value);t=e.value+(e.value-l.value)*Math.cos(V),s=e.value+(e.value-l.value)*Math.sin(V),a.vy=-a.vy*p.value}}}),a.x=t,a.y=s,a.vy*=C.value,a});for(let a=0;a<o.value.length;a++)for(let s=a+1;s<o.value.length;s++){const t=o.value[a],n=o.value[s],v=t.x-n.x,c=t.y-n.y,i=Math.sqrt(v**2+c**2),h=2*l.value;if(i<h&&i>0){const d=Math.atan2(c,v),x=h-i,f=x*Math.cos(d)/2,y=x*Math.sin(d)/2;if(t.settled||(t.x+=f,t.y+=y),n.settled||(n.x-=f,n.y-=y),Math.sqrt((t.x-e.value)**2+(t.y-e.value)**2)+l.value>e.value){const M=Math.atan2(t.y-e.value,t.x-e.value);t.x=e.value+(e.value-l.value)*Math.cos(M),t.y=e.value+(e.value-l.value)*Math.sin(M),t.vy=-t.vy*p.value}if(Math.sqrt((n.x-e.value)**2+(n.y-e.value)**2)+l.value>e.value){const M=Math.atan2(n.y-e.value,n.x-e.value);n.x=e.value+(e.value-l.value)*Math.cos(M),n.y=e.value+(e.value-l.value)*Math.sin(M),n.vy=-n.vy*p.value}}}for(let a=0;a<3;a++)R();o.value.length<_.value||o.value.some(a=>!a.settled)?u.value=requestAnimationFrame(B):cancelAnimationFrame(u.value)},R=()=>{for(let a=0;a<o.value.length;a++)for(let s=a+1;s<o.value.length;s++){const t=o.value[a],n=o.value[s],v=n.x-t.x,c=n.y-t.y,i=Math.sqrt(v*v+c*c),h=2*l.value;if(i<h&&i>0){const d=h-i,x=v/i,f=c/i,y=d/2*x,g=d/2*f;t.x-=y,t.y-=g,n.x+=y,n.y+=g,t.vx*=.8,t.vy*=.8,n.vx*=.8,n.vy*=.8}}},T=a=>{X(a)},X=async a=>{U({guess:a}).then(s=>{s.data.statusCode===1?(s.data.status==="wrong"&&(o.value=o.value.filter(t=>t.id<s.data.max_num&&s.data.min_num<t.id)),s.data.status==="correct"&&alert(s.data.message)):console.log("連線出現問題~")}).catch(s=>{console.log(s)})};return Y(()=>{q()}),j(()=>{u.value&&cancelAnimationFrame(u.value)}),{bigRadius:e,smallRadius:l,smallCircles:o,selectNumber:T}},J={class:"circle-container"},K={class:"ball-box"},Q=["width","height"],W=["cx","cy","r"],Z=["cx","cy","r","onClick"],aa=["x","y","onClick"],ea={__name:"DaVinciCdoeOld",setup(e){const{bigRadius:l,smallRadius:_,smallCircles:k,selectNumber:C}=H();return(p,o)=>(b(),D("div",J,[w("div",K,[(b(),D("svg",{width:r(l)*2,height:r(l)*2,id:"circleSvg"},[w("circle",{cx:r(l),cy:r(l),r:r(l),class:"big-circle"},null,8,W),O($,{tag:"g",name:"fade"},{default:P(()=>[(b(!0),D(S,null,E(r(k),u=>(b(),D("g",{key:u.id},[w("circle",{cx:u.x,cy:u.y,r:r(_),onClick:q=>r(C)(u.id),class:"small-circle"},null,8,Z),w("text",{x:u.x,y:u.y,onClick:q=>r(C)(u.id),"text-anchor":"middle",dy:".3em",class:"small-circle-text"},z(u.id),9,aa)]))),128))]),_:1})],8,Q))]),o[0]||(o[0]=w("div",{class:"area-info"},null,-1))]))}},la=A(ea,[["__scopeId","data-v-a8ec7a41"]]);export{la as default};
